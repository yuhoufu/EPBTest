<?xml version="1.0" encoding="utf-8"?>

<TestConfig>
	<Basic>
		<TestName>EPB_Fatigue</TestName>
		<!-- 周期次数 -->
		<TestTarget>10</TestTarget>
		<!-- 试验频率 Hz，例：10 表示 100ms -->
		<TestCycle>0.2</TestCycle>
		<StoreDir>D:\EPB_Data</StoreDir>
	</Basic>

	<Timer>
		<OverrunPolicy>AlignToWallClock</OverrunPolicy>
		<!-- 其他可选：RunToCompletionSkipMissed/SkipNextIfOverrun / AlignToWallClock / Throw -->
	</Timer>

	<!-- 液压是否参与：开关按液压编号整体控制（1 控 1~6；2 控 7~12） -->
	<Hydraulics>
		<Hydraulic>
			<Id>1</Id>
			<!-- <Enabled>true</Enabled> -->
			<Enabled>true</Enabled>
			<Mode>Either</Mode>
			<!-- ByPressure / ByDuration / Either -->
			<SetPercent>30</SetPercent>
			<!-- AO 百分比 -->
			<PressureThresholdBar>20.0</PressureThresholdBar>
			<DurationMs>800</DurationMs>
			<!-- 模式含时长时使用 -->
			<HoldAfterReachedMs>0</HoldAfterReachedMs>
			<!-- 达阈后再保持多久再泄压 -->
			<PressureDoId>1</PressureDoId>
			<!-- 对应 DOConfig/Pressure/Record/编号 -->
			<!-- 新增：该液压路控制的卡钳 -->
			<Members>1,2,3,4,5,6</Members>
		</Hydraulic>
		<Hydraulic>
			<Id>2</Id>
			<!-- <Enabled>true</Enabled> -->
			<Enabled>false</Enabled>
			<Mode>ByPressure</Mode>
			<SetPercent>28</SetPercent>
			<PressureThresholdBar>18.0</PressureThresholdBar>
			<DurationMs>0</DurationMs>
			<HoldAfterReachedMs>200</HoldAfterReachedMs>
			<PressureDoId>2</PressureDoId>
			<Members>7,8,9,10,11,12</Members>
		</Hydraulic>
	</Hydraulics>

	<!-- EPB 电流阈值（正/反），用于“到达即换向/关闭” -->
	<EpbCurrentLimits>
		<Record>
			<Channel>1</Channel>
			<ForwardA>3</ForwardA>
			<ReverseA>2</ReverseA>
		</Record>
		<Record>
			<Channel>2</Channel>
			<ForwardA>9.0</ForwardA>
			<ReverseA>6.0</ReverseA>
		</Record>
		<Record>
			<Channel>3</Channel>
			<ForwardA>9.0</ForwardA>
			<ReverseA>6.0</ReverseA>
		</Record>
		<Record>
			<Channel>4</Channel>
			<ForwardA>9.0</ForwardA>
			<ReverseA>6.0</ReverseA>
		</Record>
		<Record>
			<Channel>5</Channel>
			<ForwardA>9.0</ForwardA>
			<ReverseA>6.0</ReverseA>
		</Record>
		<Record>
			<Channel>6</Channel>
			<ForwardA>9.0</ForwardA>
			<ReverseA>6.0</ReverseA>
		</Record>
		<Record>
			<Channel>7</Channel>
			<ForwardA>9.0</ForwardA>
			<ReverseA>6.0</ReverseA>
		</Record>
		<Record>
			<Channel>8</Channel>
			<ForwardA>9.0</ForwardA>
			<ReverseA>6.0</ReverseA>
		</Record>
		<Record>
			<Channel>9</Channel>
			<ForwardA>9.0</ForwardA>
			<ReverseA>6.0</ReverseA>
		</Record>
		<Record>
			<Channel>10</Channel>
			<ForwardA>9.0</ForwardA>
			<ReverseA>6.0</ReverseA>
		</Record>
		<Record>
			<Channel>11</Channel>
			<ForwardA>9.0</ForwardA>
			<ReverseA>6.0</ReverseA>
		</Record>
		<Record>
			<Channel>12</Channel>
			<ForwardA>9.0</ForwardA>
			<ReverseA>6.0</ReverseA>
		</Record>
		<!-- ... 直到 12 -->
	</EpbCurrentLimits>

	<!-- 同组电控起始错峰，仅针对“电控”步骤；不同组可同时起 -->
	<ElectricalGroups>
		<Group>
			<Id>1</Id>
			<StaggerMs>800</StaggerMs>
			<Members>1,2,3</Members>
			<!-- 供电1->3 的一个示意，实际按现场配置 -->
		</Group>
		<Group>
			<Id>2</Id>
			<StaggerMs>800</StaggerMs>
			<Members>4,5,6</Members>
		</Group>
		<Group>
			<Id>3</Id>
			<StaggerMs>800</StaggerMs>
			<Members>7,8,9</Members>
		</Group>
		<Group>
			<Id>4</Id>
			<StaggerMs>800</StaggerMs>
			<Members>10,11,12</Members>
		</Group>
	</ElectricalGroups>

	<!--
    ===== EPB 循环控制器（EpbCycleRunner） =====
    参数意义与建议范围（来自2025-08-20 CSV 实测 + 经验）：
      PeakIgnoreMs           : 上电涌流忽略时间；建议 80–150 ms，默认 100 ms
      EmptyBandA             : 空行程电流稳定带宽；建议 0.15–0.30 A，默认 0.20 A
      StableWinMs            : 判定“空行程稳定”的最小持续时间；建议 50–100 ms，默认 50 ms
      EwmaAlpha              : EWMA 一阶低通的灵敏度；建议 0.15–0.30，默认 0.20
      EmptyCurrentForwardA   : 正向空行程均值（本次实测 ~ +0.63 A）
      EmptyCurrentReverseA   : 反向空行程均值（本次实测 ~ -0.70 A）
    调参建议：
      - 若现场噪声偏大：适度↑ EmptyBandA 或 ↑ StableWinMs
      - 若峰值拖尾较长：适度↑ PeakIgnoreMs
      - 若响应偏慢：适度↑ EwmaAlpha（同时注意抗噪能力降低）
  -->
	<EpbCycleRunnerConfig>
		<PeakIgnoreMs>100</PeakIgnoreMs>
		<EmptyBandA>0.20</EmptyBandA>
		<StableWinMs>50</StableWinMs>
		<EwmaAlpha>0.20</EwmaAlpha>
		<EmptyCurrentForwardA>0.63</EmptyCurrentForwardA>
		<EmptyCurrentReverseA>-0.70</EmptyCurrentReverseA>
	</EpbCycleRunnerConfig>

</TestConfig>